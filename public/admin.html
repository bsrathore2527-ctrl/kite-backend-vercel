<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Guardian Admin</title>

<style>
/* ---- THEME VARIABLES ---- */
:root {
  --bg:#0c0f17;
  --bg2:#111826;
  --text:#ffffff;
  --muted:#8fa2c7;
  --card:#121b2b;
  --card2:#0d1522;
  --border:#1f2a3a;
  --accent:#3a6cff;
  --accent-hover:#5c83ff;
}
body.theme-light {
  --bg:#f3f5fa;
  --bg2:#ffffff;
  --text:#0f172a;
  --muted:#4c5569;
  --card:#ffffff;
  --card2:#f8f9fc;
  --border:#d5d9e0;
  --accent:#2563eb;
  --accent-hover:#3b82f6;
}

/* ---- BASE ---- */
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,Roboto,Arial;}
body{
  background:var(--bg);
  color:var(--text);
  height:100vh;
  overflow:hidden;
}

/* ---- HEADER ---- */
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 18px;
  background:var(--bg2);
  border-bottom:1px solid var(--border);
}
.header-left{display:flex;align-items:center;gap:14px;}
.avatar{
  width:44px;height:44px;border-radius:50%;
  background:var(--card);
  display:flex;align-items:center;justify-content:center;
  font-size:20px;font-weight:700;
}
.header-titles h1{font-size:20px;font-weight:700;}
.header-titles small{color:var(--muted);font-size:13px;}

.theme-toggle{
  padding:8px 12px;
  border-radius:10px;
  background:var(--card);
  cursor:pointer;
  border:1px solid var(--border);
}

/* ---- TABS ---- */
.top-tabs{
  display:flex;
  background:var(--bg2);
  border-bottom:1px solid var(--border);
}
.top-tabs button{
  flex:1;
  padding:14px;
  background:none;
  border:none;
  color:var(--muted);
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}
.top-tabs button.active{
  color:var(--text);
  background:var(--card);
  border-bottom:3px solid var(--accent);
}

/* ---- PAGE ---- */
.page{
  height:calc(100vh - 110px);
  overflow-y:auto;
  padding:18px;
  display:none;
}
.page.active{display:block;}

/* ---- GRID CARDS ---- */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(220px,1fr));
  gap:14px;
}
.card{
  background:var(--card);
  border-radius:12px;
  padding:14px;
  border:1px solid var(--border);
}
.card h3{color:var(--muted);font-size:14px;margin-bottom:5px;}
.card p{font-size:22px;font-weight:700;}
.card small{color:var(--muted);font-size:12px;}

/* ---- SUBTAB ---- */
.subtoggle{
  display:flex;
  background:var(--bg2);
  border-radius:14px;
  padding:6px;
  margin-bottom:14px;
}
.subtoggle button{
  flex:1;
  padding:10px;
  background:none;
  border:none;
  color:var(--muted);
}
.subtoggle button.active{
  background:var(--accent);
  color:#fff;
}

/* ---- TABLE ---- */
.table-wrap{
  height:450px;
  overflow-y:auto;
  border-radius:10px;
  border:1px solid var(--border);
}
table{width:100%;border-collapse:collapse;}
th{
  position:sticky;top:0;
  background:var(--card2);
  padding:10px;
  color:var(--muted);
  border-bottom:1px solid var(--border);
}
td{
  padding:10px;
  border-bottom:1px solid var(--border);
}
.red{color:#ff6b6b;}
.green{color:#66e066;}

/* ---- ADMIN CARDS ---- */
.admin-card{
  background:var(--card);
  border-radius:12px;
  padding:16px;
  margin-bottom:16px;
  border:1px solid var(--border);
}
.admin-card h2{font-size:18px;font-weight:600;margin-bottom:10px;}
.admin-card button{
  background:var(--accent);
  padding:10px 16px;
  border-radius:10px;
  color:#fff;
  border:none;
  cursor:pointer;
}
input,select{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid var(--border);
  background:var(--card2);
}
</style>
</head>

<body>

<div class="header">
  <div class="header-left">
    <div class="avatar">G</div>
    <div class="header-titles">
      <h1>Guardian Admin</h1>
      <small>Risk Automation & Control Panel</small>
    </div>
  </div>
  <div class="theme-toggle" onclick="toggleTheme()">üåì</div>
</div>

<div class="top-tabs">
  <button id="tab-overview" onclick="switchTab('overview')" class="active">üè† Overview</button>
  <button id="tab-trades" onclick="switchTab('trades')">üìà Trades</button>
  <button id="tab-admin" onclick="switchTab('admin')">‚öôÔ∏è Admin</button>
</div>

<!-- OVERVIEW -->
<div id="page-overview" class="page active">
  <div class="grid">
    <div class="card"><h3>Capital @ 09:15</h3><p id="capital_val">--</p></div>
    <div class="card"><h3>Balance</h3><p id="balance_val">--</p></div>
    <div class="card"><h3>Live MTM</h3><p id="live_mtm">--</p></div>
    <div class="card"><h3>Total PnL</h3><p id="total_pnl">--</p></div>
    <div class="card"><h3>Max Loss</h3><p id="max_loss_val">--</p><small id="max_loss_pct">--%</small></div>
    <div class="card"><h3>Max Profit</h3><p id="max_profit_val">--</p><small id="max_profit_pct">--%</small></div>
    <div class="card"><h3>Consecutive Loss</h3><p id="consec_loss">--</p></div>
    <div class="card"><h3>Kill Switch</h3><p id="kill_status">--</p></div>
    <div class="card"><h3>System Status</h3><p id="system_status">--</p></div>
    <div class="card"><h3>Last Update</h3><p id="last_update">--</p></div>
  </div>
</div>

<!-- TRADES -->
<div id="page-trades" class="page">
  <div class="subtoggle">
    <button id="tradeBtn" onclick="switchSubTab('trade')" class="active">Trade Book</button>
    <button id="sellBtn" onclick="switchSubTab('sell')">Sell Book</button>
  </div>
  <div class="table-wrap" id="tradesTable"></div>
</div>

<!-- ADMIN -->
<div id="page-admin" class="page">
  <div class="admin-card">
    <h2>Admin Token</h2>
    <input id="admin_token" />
    <button onclick="saveAdminToken()">Save Token</button>
  </div>

  <div class="admin-card">
    <h2>Set Config</h2>
    <input id="cfg_max_loss" type="number" placeholder="Max Loss">
    <input id="cfg_max_profit" type="number" placeholder="Max Profit">
    <input id="cfg_max_loss_trades" type="number" placeholder="Max Consecutive Loss">
    <button onclick="saveConfig()">Save Config</button>
  </div>

  <div class="admin-card">
    <h2>Set Capital</h2>
    <input id="capital_input" type="number">
    <button onclick="saveCapital()">Save Capital</button>
  </div>

  <div class="admin-card">
    <h2>Kill Switch</h2>
    <button onclick="killSwitch()" style="background:#d9534f">Kill Now</button>
  </div>

  <div class="admin-card">
    <h2>Reset Day</h2>
    <button onclick="resetDay()" style="background:#cc9900">Reset Now</button>
  </div>

  <div class="admin-card">
    <h2>Enforce</h2>
    <select id="enforce_mode">
      <option value="auto">Auto</option>
      <option value="manual">Manual</option>
    </select>
    <select id="enforce_mtm_source">
      <option value="funds">Kite Funds</option>
      <option value="state">State Poller</option>
    </select>
    <button onclick="saveEnforce()">Save Enforcement Settings</button>
  </div>

</div>

<!-- LOAD CLEAN JS -->
<script src="/admin.js"></script>

</body>
</html>
