<!DOCTYPE html>
<html lang="en" class="dark">
color: var(--text-light);
}
html.dark input[type=text],
html.dark input[type=password],
html.dark input[type=number] {
border-color: rgba(255,255,255,0.1);
background: #0f172a;
color: var(--text-dark);
}


/* Header Logo */
.logo {
width: 52px;
height: 52px;
border-radius: 12px;
background: linear-gradient(135deg,#fef3c7,#fdba74);
display: grid;
place-items: center;
font-weight: 700;
color: #b45309;
}


/* Status Pills */
.badge {
padding: 6px 12px;
border-radius: 999px;
background: rgba(0,0,0,0.05);
}
html.dark .badge {
background: rgba(255,255,255,0.07);
}


.status-pill.status-active {
background: rgba(16,185,129,0.15);
color: #10b981;
}


.status-pill.status-tripped {
background: rgba(239,68,68,0.2);
color: #ef4444;
}


</style>
</head>
<body>
<div class="wrap" style="max-width:980px;margin:16px auto;padding:14px">


<header style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
<div class="logo">G</div>
<div>
<h1 style="margin:0;font-size:22px;font-weight:700">Guardian — Admin</h1>
<div class="muted small">Risk automation & enforcement</div>
</div>


<div class="status" style="margin-left:auto;display:flex;gap:8px;align-items:center;font-size:13px">
<div id="kite_status" class="badge">Kite: —</div>
<div id="guardian_status" class="badge">Guardian: —</div>
<div id="day_status" class="badge status-pill">—</div>
<div id="now" class="badge">--:--:--</div>
</div>
</header>

  <!-- ORIGINAL SCRIPT (UNTOUCHED) -->
  <script>
    async function refreshState() {
      const res = await fetch("/api/state", {
        headers: { Authorization: "Bearer " + ADMIN_TOKEN }
      });
      document.getElementById("state_output").textContent = await res.text();
    }

    async function refreshPositions() {
      const res = await fetch("/api/positions", {
        headers: { Authorization: "Bearer " + ADMIN_TOKEN }
      });
      document.getElementById("positions_output").textContent = await res.text();
    }

    async function refreshLogs() {
      const res = await fetch("/api/logs", {
        headers: { Authorization: "Bearer " + ADMIN_TOKEN }
      });
      document.getElementById("logs_output").textContent = await res.text();
    }

    async function kill() {
      await fetch("/api/admin/kill", {
        method: "POST",
        headers: { Authorization: "Bearer " + ADMIN_TOKEN }
      });
      refreshState();
    }

    async function cancelAll() {
      await fetch("/api/admin/cancel", {
        method: "POST",
        headers: { Authorization: "Bearer " + ADMIN_TOKEN }
      });
    }

    async function saveConfig() {
      const body = {
        maxLoss: document.getElementById("maxLoss").value,
        maxProfit: document.getElementById("maxProfit").value,
        trailStep: document.getElementById("trailStep").value
      };

      await fetch("/api/admin/set-config", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + ADMIN_TOKEN
        },
        body: JSON.stringify(body)
      });
    }

    function showTab(id) {
      document.querySelectorAll(".tab").forEach(x => x.classList.remove("active"));
      document.querySelectorAll(".tab-button").forEach(x => x.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      event.target.classList.add("active");
    }
  </script>

</body>
</html>
